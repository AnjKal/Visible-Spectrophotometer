clear
l=zeros(1,401);
l=[529,537,533,522,503,517,521,534,530,684,685,632,599,541,603,625,545,521,539,524,522,503,451,448,451,454,455,446,445,435,447,454,437,437,413,424,440,459,443,459,422,426,435,475,497,490,494,475,494,517,513,506,492,470,495,507,504,510,505,488,494,460,469,492,493,471,493,506,532,540,535,506,521,519,521,526,526,536,527,530,537,529,512,507,515,517,535,541,538,527,522,530,527,524,525,520,534,550,548,544,520,527,522,536,538,551,541,539,528,547,546,546,536,526,523,540,543,537,551,519,519,539,544,537,535,535,537,531,527,529,536,517,523,544,552,546,535,540,520,524,538,537,519,533,542,539,544,547,540,525,518,526,546,538,535,528,515,529,529,527,531,526,524,528,529,541,530,528,508,525,528,535,535,543,531,525,537,525,515,520,513,541,538,549,530,535,538,529,539,555,545,547,525,531,533,549,542,530,514,528,529,560,551,537,534,533,532,547,531,544,526,550,562,536,538,531,527,524,530,540,563,543,538,547,551,557,533,551,535,568,570,572,582,565,551,562,561,589,568,560,561,574,569,579,579,584,565,555,569,580]
V=l*5/1023;
R=100./((5+V)./V)
a=(10*log10(R))/100;
w=[450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699];
max(a)
indices = find(a == max(a));
correspondingValues = w(indices);
a = real(a);
w = real(w);
[peaks, peak_indices] = findpeaks(a, 'SortStr', 'descend');
tallest_peak = peaks(1);
tallest_peak_index = peak_indices(1);
plot(w, a,'k');
hold on;
title('Absorption spectrum');
xlabel('Wavelength');
ylabel('Absorbance');
legend('Curve', 'Absorbtion Maxima');
hold off;
tallest_peak
w(tallest_peak_index)
gaussianModel = fittype('A * exp(-(w - mu)^2 / (2 * sigma^2))', 'independent', 'w', 'dependent', 'a');
initialValues = [max(a), mean(w), std(w)];
fitResult = fit(w', a', gaussianModel, 'StartPoint', initialValues);
[maxValue, maxIndex] = max(fitResult(w));
correspondingW = w(maxIndex);
figure;
plot(w, a, 'o', 'DisplayName', 'Original Data');
hold on;
plot(w, fitResult(w), 'r', 'DisplayName', 'Gaussian Fit');
plot(correspondingW, maxValue, 'Rd', 'MarkerSize', 10, 'DisplayName', 'Max Value');
legend('show');
xlabel('wavelength');
ylabel('absorbance');
title('Gaussian Fit Example');
fprintf('Maximum Value of Gaussian Curve: %f\n', maxValue);
fprintf('Corresponding w Value: %f\n', correspondingW);
window_size = 65;
smoothed_v = smooth(w, a, window_size);
figure;
hold on;
plot(w, smoothed_v, 'r-', 'LineWidth', 2, 'DisplayName', 'Smoothed Curve');
xlabel('wavelength');
ylabel('absorbance');
title('Smoothing Curve in MATLAB');
legend('show');
hold off;


